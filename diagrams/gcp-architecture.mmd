graph TD
    subgraph VM["<b>hindsight-vm</b> &nbsp;(e2-medium: 4 vCPU, 5.3 GB RAM)<br/>GCP Project: hindsight-prod-9802 &nbsp;|&nbsp; Region: us-south1-a"]
        direction LR
        subgraph C1["hindsight container"]
            MCP["MCP Server<br/><i>port 8888</i>"]
            UI["Web UI<br/><i>port 9999</i>"]
            FR["FlashRank ONNX<br/>Reranker"]
            EMB["Local Embeddings<br/>BAAI/bge-small-en-v1.5"]
        end
        subgraph C2["litellm-proxy container"]
            LIT["LiteLLM Proxy<br/><i>port 4000</i>"]
            BED["Routes to<br/>AWS Bedrock"]
            MOD["Claude Opus 4.5"]
        end
        NET["app_hindsight-net<br/><i>Docker bridge network</i>"]
    end

    subgraph DB["Cloud SQL"]
        PG["PostgreSQL<br/><i>34.174.59.142:5432</i>"]
        BAK["Managed Backups"]
        HA["High Availability"]
    end

    MCP -->|"OpenAI-format<br/>API calls"| LIT
    MCP --> PG

    style VM fill:#e3edf7,stroke:#2c5f8a,stroke-width:2px,color:#1a1a1a
    style C1 fill:#cde0f2,stroke:#2c5f8a,stroke-width:1px,color:#1a1a1a
    style C2 fill:#cde0f2,stroke:#2c5f8a,stroke-width:1px,color:#1a1a1a
    style DB fill:#fef3e0,stroke:#c07d0e,stroke-width:2px,color:#1a1a1a
    style NET fill:#f0f4f8,stroke:#999,stroke-width:1px,color:#555
    style MCP fill:#4A90D9,stroke:#2c5f8a,color:#fff
    style LIT fill:#4A90D9,stroke:#2c5f8a,color:#fff
    style PG fill:#F5A623,stroke:#c07d0e,color:#fff
